{
    "title": "Telegram Bot Metrics",
    "uid": "telegram-bot",
    "editable": true,
    "timezone": "browser",
    "refresh": "5s",
    "panels": [
        {
            "title": "Commands Over Time",
            "type": "graph",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 0
            },
            "targets": [
                {
                    "expr": "increase(telegram_commands_processed_total[5m])",
                    "legendFormat": "{{command}}"
                }
            ],
            "yaxes": [
                {
                    "format": "short",
                    "label": "Count (5m window)"
                },
                {
                    "show": false
                }
            ]
        },
        {
            "title": "Messages Over Time",
            "type": "graph",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 0
            },
            "targets": [
                {
                    "expr": "increase(telegram_messages_processed_total[5m])",
                    "legendFormat": "{{type}}"
                }
            ],
            "yaxes": [
                {
                    "format": "short",
                    "label": "Count (5m window)"
                },
                {
                    "show": false
                }
            ]
        },
        {
            "title": "Buttons Pressed Over Time",
            "type": "graph",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 8
            },
            "targets": [
                {
                    "expr": "increase(telegram_buttons_pressed_total[5m])",
                    "legendFormat": "{{button}}"
                }
            ],
            "yaxes": [
                {
                    "format": "short",
                    "label": "Count (5m window)"
                },
                {
                    "show": false
                }
            ]
        },
        {
            "title": "Callbacks Over Time",
            "type": "graph",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 8
            },
            "targets": [
                {
                    "expr": "increase(telegram_callbacks_processed_total[5m])",
                    "legendFormat": "{{action}}"
                }
            ],
            "yaxes": [
                {
                    "format": "short",
                    "label": "Count (5m window)"
                },
                {
                    "show": false
                }
            ]
        },
        {
            "title": "Total Commands & Messages",
            "type": "stat",
            "gridPos": {
                "h": 4,
                "w": 12,
                "x": 0,
                "y": 16
            },
            "targets": [
                {
                    "expr": "sum(telegram_commands_processed_total)",
                    "legendFormat": "Commands"
                },
                {
                    "expr": "sum(telegram_messages_processed_total)",
                    "legendFormat": "Messages"
                }
            ],
            "fieldConfig": {
                "defaults": {
                    "unit": "short"
                }
            }
        },
        {
            "title": "Total Buttons & Callbacks",
            "type": "stat",
            "gridPos": {
                "h": 4,
                "w": 12,
                "x": 12,
                "y": 16
            },
            "targets": [
                {
                    "expr": "sum(telegram_buttons_pressed_total)",
                    "legendFormat": "Buttons"
                },
                {
                    "expr": "sum(telegram_callbacks_processed_total)",
                    "legendFormat": "Callbacks"
                }
            ],
            "fieldConfig": {
                "defaults": {
                    "unit": "short"
                }
            }
        },
        {
            "title": "Total Expenses & Categories",
            "type": "stat",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 20
            },
            "targets": [
                {
                    "expr": "telegram_expenses_created_total",
                    "legendFormat": "Expenses"
                },
                {
                    "expr": "telegram_categories_created_total",
                    "legendFormat": "Categories"
                }
            ],
            "fieldConfig": {
                "defaults": {
                    "unit": "short"
                }
            }
        },
        {
            "title": "Expenses & Categories Over Time",
            "type": "graph",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 20
            },
            "targets": [
                {
                    "expr": "increase(telegram_expenses_created_total[5m])",
                    "legendFormat": "Expenses"
                },
                {
                    "expr": "increase(telegram_categories_created_total[5m])",
                    "legendFormat": "Categories"
                }
            ],
            "yaxes": [
                {
                    "format": "short",
                    "label": "Count (5m window)"
                },
                {
                    "show": false
                }
            ]
        },
        {
            "title": "Errors Over Time",
            "type": "graph",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 28
            },
            "targets": [
                {
                    "expr": "increase(telegram_errors_total[5m])",
                    "legendFormat": "{{type}}"
                }
            ],
            "yaxes": [
                {
                    "format": "short",
                    "label": "Count (5m window)"
                },
                {
                    "show": false
                }
            ]
        },
        {
            "title": "Total LLM Parses & Transcriptions",
            "type": "stat",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 28
            },
            "targets": [
                {
                    "expr": "telegram_llm_parse_duration_seconds_count",
                    "legendFormat": "LLM Parses"
                },
                {
                    "expr": "telegram_transcription_duration_seconds_count",
                    "legendFormat": "Transcriptions"
                }
            ],
            "fieldConfig": {
                "defaults": {
                    "unit": "short"
                }
            }
        },
        {
            "title": "LLM Parse Duration: Count <= Threshold",
            "type": "graph",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 36
            },
            "targets": [
                {
                    "expr": "increase(telegram_llm_parse_duration_seconds_bucket{le=\"0.5\"}[5m])",
                    "legendFormat": "<= 0.5s"
                },
                {
                    "expr": "increase(telegram_llm_parse_duration_seconds_bucket{le=\"2.5\"}[5m])",
                    "legendFormat": "<= 2.5s"
                },
                {
                    "expr": "increase(telegram_llm_parse_duration_seconds_count[5m])",
                    "legendFormat": "Total"
                }
            ],
            "yaxes": [
                {
                    "format": "short",
                    "label": "Count",
                    "decimals": 0
                },
                {
                    "show": false
                }
            ]
        },
        {
            "title": "Transcription Duration: Count <= Threshold",
            "type": "graph",
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 36
            },
            "targets": [
                {
                    "expr": "increase(telegram_transcription_duration_seconds_bucket{le=\"2.5\"}[5m])",
                    "legendFormat": "<= 2.5s"
                },
                {
                    "expr": "increase(telegram_transcription_duration_seconds_count[5m])",
                    "legendFormat": "Total"
                }
            ],
            "yaxes": [
                {
                    "format": "short",
                    "label": "Count",
                    "decimals": 0
                },
                {
                    "show": false
                }
            ]
        }
    ]
}
